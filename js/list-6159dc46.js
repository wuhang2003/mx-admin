import{d as y,m as h,u as b,f as w,w as j,j as C,k as e,F as k,R as c,A as x,bB as P,ak as E,s as l,bb as D,bC as F,t as R,p as u,q as B,bD as S,E as A,n as M,bE as T,C as U,M as q}from"./index-3c95053e.js";import{D as z}from"./delete-confirm-8a5c1f74.js";import{R as I}from"./relative-time-0ad8cce8.js";import{u as V}from"./use-table-09e3e9a6.js";import{H as L}from"./rounded-button-308fbee1.js";import{N as _}from"./Checkbox-4c49605e.js";import{N as H,a as K}from"./Pagination-955024e6.js";import{N as O,a as G}from"./ListItem-f22af333.js";import{N as J}from"./ButtonGroup-d351298b.js";import{N as d}from"./Avatar-a2e9d1a1.js";import"./prop-8b8caa29.js";import"./Select-f4a51811.js";import"./Tag-e0bc3d96.js";import"./Forward-6cab11cb.js";import"./utils-58a49e2e.js";function Q(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!q(s)}const pe=y({setup(){const{data:s,pager:o,sortProps:W,fetchDataFn:f,loading:m}=V((a,t)=>async(N=i.query.page||1,v=30)=>{const p=await c.api.projects.get({params:{page:N,size:v}});a.value=p.data,t.value=p.pagination}),r=h(new Set),g=b(),i=w(),n=f;return j(()=>i.query.page,async a=>{await n(a)}),C(async()=>{await n()}),()=>e(U,null,{actions:()=>e(k,null,[e(z,{checkedRowKeys:r,onDelete:async()=>{await Promise.all(Array.from(r.values()).map(a=>c.api.projects(a).delete())),r.clear(),n()}},null),e(L,{to:"/projects/edit",icon:e(x,null,null)},null)]),default:()=>e(P,{show:m.value},{default:()=>[e(O,{bordered:!1,class:"min-h-[300px] bg-transparent"},{footer(){return e("div",{class:"flex justify-end"},[e(H,{itemCount:o.value.total,pageCount:o.value.totalPage,page:o.value.currentPage,pageSize:o.value.size,onUpdatePage:a=>{n(a)}},null)])},default(){return s.value.map(a=>e(G,{key:a.id},{prefix(){return e(_,{class:"mt-4",checked:r.has(a.id),onUpdateChecked:t=>{t?r.add(a.id):r.delete(a.id)}},null)},default(){return e(E,{description:a.description},{header(){return e("div",null,[e(l,D({ghost:!0,type:"primary",text:!0,class:"!font-medium"},a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}),{default:()=>[a.name]})])},footer(){return e(F,null,{default:()=>[e(R,{class:"pl-[3.6rem] text-[var(--clear-color-pressed)] text-sm"},{default:()=>[e("span",null,[u("创建于 "),B(a.created)]),a.modified&&e("span",null,[u("更新于")," ",e(I,{time:a.modified},null)])]})]})},"header-extra":function(){return e(J,null,{default:()=>[e(l,{onClick:()=>{S.push({name:A.EditProject,query:{id:a.id}})}},{default:()=>[u("编辑")]}),e(K,{class:"!p-0",options:[{value:"del",label:"",render(){return e(l,{type:"error",bordered:!1,onClick:async()=>{await c.api.projects(a.id).delete(),g.success("删除成功"),await n(o.value.currentPage)}},{default:()=>[u("删除")]})}}]},{default:()=>[e(l,{class:"!px-2"},{default:()=>[e(M,null,{default:()=>[e(T,null,null)]})]})]})]})},avatar(){let t;return a.avatar?e(d,{class:"align-center",circle:!0,src:a.avatar,size:"large"},null):e(d,{circle:!0,size:"large",class:"align-center"},Q(t=a.name[0].toUpperCase())?t:{default:()=>[t]})}})}}))}})]})})}});export{pe as default};
