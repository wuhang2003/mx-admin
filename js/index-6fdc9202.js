import{d as w,r as N,h as a,J as _,l as n,k as c}from"./index-ecb87ff2.js";import{N as I}from"./Form-f2c31d2d.js";import{N as i}from"./FormItem-5bce587a.js";import{N as m}from"./Select-8522f26d.js";import{N as v}from"./Switch-4b502692.js";import"./Tag-420d8e91.js";const f="mx-admin:setup-api:url",d="mx-admin:setup-api:gateway",O=w({setup(){const t=N({apiUrl:localStorage.getItem("__api")||"",gatewayUrl:localStorage.getItem("__gateway")||"",persist:!1}),o=()=>{const e=new URL(location.href),{apiUrl:u,gatewayUrl:p,persist:S}=t,l=g(u),r=g(p);l&&e.searchParams.set("__api",l),r&&e.searchParams.set("__gateway",r),S&&(l&&localStorage.setItem("__api",l),r&&localStorage.setItem("__gateway",r)),e.pathname="/",e.hash="",localStorage.setItem(f,JSON.stringify([...new Set(s.concat(u))])),localStorage.setItem(d,JSON.stringify([...new Set(s.concat(p))])),location.href=e.toString()},h=()=>{localStorage.removeItem("__api"),localStorage.removeItem("__gateway"),location.href="/"},y=()=>{t.apiUrl="http://localhost:2333",t.gatewayUrl="http://localhost:2333"},s=JSON.safeParse(localStorage.getItem(f)||"[]"),U=JSON.safeParse(localStorage.getItem(d)||"[]");return()=>a("div",{class:"relative flex h-screen w-full items-center justify-center"},[a(_,{title:"设置 API",class:"modal-card sm form-card m-auto"},{default:()=>[a(I,{onSubmit:o},{default:()=>[a(i,{label:"API 地址"},{default:()=>[a(m,{options:s.map(e=>({key:e,value:e,label:e})),filterable:!0,tag:!0,clearable:!0,value:t.apiUrl,onUpdateValue:e=>{t.apiUrl=e}},null)]}),a(i,{label:"Gateway 地址"},{default:()=>[a(m,{tag:!0,options:U.map(e=>({key:e,value:e,label:e})),filterable:!0,clearable:!0,value:t.gatewayUrl,onUpdateValue:e=>{t.gatewayUrl=e}},null)]}),a(i,{label:"持久化",labelPlacement:"left"},{default:()=>[a(v,{value:t.persist,onUpdateValue:e=>{t.persist=e}},null)]}),a("div",{class:"space-x-2 text-center"},[a(n,{onClick:y,round:!0},{default:()=>[c("本地调试")]}),a(n,{onClick:h,round:!0},{default:()=>[c("重置")]}),a(n,{onClick:o,round:!0,type:"primary"},{default:()=>[c("确定")]})])]})]})])}}),g=t=>t?t.startsWith("http")?t:`${["localhost","127.0.0.1"].indexOf(t)>-1?"http":"https"}://${t}`:"";export{O as default};
