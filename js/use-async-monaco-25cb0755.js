import{_ as ne}from"./preload-helper-f651ca80.js";import{u as ae,C as ie}from"./index-6a5b60dd.js";import{c as l,ai as oe}from"./app-447ba742.js";import{r as U}from"./index-1b8f17cb.js";import{e as se}from"./editor.main-2236456e.js";import{i as ce,u as ue}from"./use-store-ref-095f705c.js";import{u as le}from"./use-save-confirm-5396f481.js";import{y as Y,au as q,k as fe,v as de,bg as he,R as pe,bz as ve}from"./Button-5ec267f1.js";var z={},N={},x={},A={};Object.defineProperty(A,"__esModule",{value:!0});A.DummySourceCache=void 0;var ye=function(){function n(){}return n.prototype.getFile=function(t){return Promise.resolve(void 0)},n.prototype.isFileAvailable=function(t){return Promise.resolve(!1)},n.prototype.storeFile=function(t,e){return Promise.resolve(void 0)},n.prototype.clear=function(){return Promise.resolve(void 0)},n}();A.DummySourceCache=ye;var C={},K=l&&l.__awaiter||function(n,t,e,i){function a(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function c(u){try{o(i.next(u))}catch(d){s(d)}}function f(u){try{o(i.throw(u))}catch(d){s(d)}}function o(u){u.done?r(u.value):a(u.value).then(c,f)}o((i=i.apply(n,t||[])).next())})},G=l&&l.__generator||function(n,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(o){return function(u){return f([o,u])}}function f(o){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,a&&(r=o[0]&2?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){e.label=o[1];break}if(o[0]===6&&e.label<r[1]){e.label=r[1],r=o;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(o);break}r[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(u){o=[6,u],a=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(C,"__esModule",{value:!0});C.UnpkgSourceResolver=void 0;var ge=function(){function n(){}return n.prototype.resolvePackageJson=function(t,e,i){return K(this,void 0,void 0,function(){return G(this,function(a){switch(a.label){case 0:return[4,this.resolveFile("https://unpkg.com/".concat(t).concat(e?"@".concat(e):"").concat(i?"/".concat(i):"","/package.json"))];case 1:return[2,a.sent()]}})})},n.prototype.resolveSourceFile=function(t,e,i){return K(this,void 0,void 0,function(){return G(this,function(a){switch(a.label){case 0:return[4,this.resolveFile("https://unpkg.com/".concat(t).concat(e?"@".concat(e):"","/").concat(i))];case 1:return[2,a.sent()]}})})},n.prototype.resolveFile=function(t){return K(this,void 0,void 0,function(){var e;return G(this,function(i){switch(i.label){case 0:return[4,fetch(t,{method:"GET"})];case 1:return e=i.sent(),e.ok?[4,e.text()]:[3,3];case 2:return[2,i.sent()];case 3:if(e.status===404)return[2,""];throw Error("Error other than 404 while fetching from Unpkg at ".concat(t));case 4:return[2]}})})},n}();C.UnpkgSourceResolver=ge;var $={},L={},_e=l&&l.__createBinding||(Object.create?function(n,t,e,i){i===void 0&&(i=e);var a=Object.getOwnPropertyDescriptor(t,e);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,a)}:function(n,t,e,i){i===void 0&&(i=e),n[i]=t[e]}),me=l&&l.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),be=l&&l.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&_e(t,n,e);return me(t,n),t},we=l&&l.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var i=e.call(n),a,r=[],s;try{for(;(t===void 0||t-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(c){s={error:c}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(s)throw s.error}}return r},ke=l&&l.__spreadArray||function(n,t,e){if(e||arguments.length===2)for(var i=0,a=t.length,r;i<a;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(L,"__esModule",{value:!0});L.DependencyParser=void 0;var Pe=be(U()),Se=function(){function n(){this.REGEX_CLEAN=/[\n|\r]/g,this.REGEX_DETECT_IMPORT=/(?:(?:(?:import)|(?:export))(?:.)*?from\s+["']([^"']+)["'])|(?:require(?:\s+)?\(["']([^"']+)["']\))|(?:\/+\s+<reference\s+path=["']([^"']+)["']\s+\/>)/g,this.REGEX_NODE_MODULE=/^node:([\w\W\/]+)$/}return n.prototype.parseDependencies=function(t,e){var i=this,a=t;return ke([],we(a.matchAll(this.REGEX_DETECT_IMPORT)),!1).map(function(r){var s,c;return(c=(s=r[1])!==null&&s!==void 0?s:r[2])!==null&&c!==void 0?c:r[3]}).filter(function(r){return!!r}).map(function(r){return i.resolvePath(r,e)})},n.prototype.resolvePath=function(t,e){var i=t.match(this.REGEX_NODE_MODULE);if(i)return{kind:"relative-in-package",packageName:"@types/node",importPath:"".concat(i[1],".d.ts"),sourcePath:""};if(typeof e=="string"){if(t.startsWith("."))return{kind:"relative",importPath:t,sourcePath:e};if(t.startsWith("@")){var a=t.split("/");return{kind:"package",packageName:"".concat(a[0],"/").concat(a[1]),importPath:a.slice(2).join("/")}}else{var a=t.split("/");return{kind:"package",packageName:a[0],importPath:a.slice(1).join("/")}}}else switch(e.kind){case"package":throw Error("TODO?");case"relative":throw Error("TODO2?");case"relative-in-package":if(t.startsWith("."))return{kind:"relative-in-package",packageName:e.packageName,sourcePath:Pe.join(e.sourcePath,e.importPath),importPath:t};if(t.startsWith("@")){var a=t.split("/");return{kind:"package",packageName:"".concat(a[0],"/").concat(a[1]),importPath:a.slice(2).join("/")}}else{var a=t.split("/");return{kind:"package",packageName:a[0],importPath:a.slice(1).join("/")}}}},n}();L.DependencyParser=Se;var D={},Oe=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(D,"__esModule",{value:!0});D.importResourcePathToString=void 0;var J=Oe(U()),je=function(n){var t;switch(n.kind){case"package":return J.default.join(n.packageName,(t=n.importPath)!==null&&t!==void 0?t:"","package.json");case"relative":return J.default.join(n.sourcePath,n.importPath);case"relative-in-package":return J.default.join(n.packageName,n.sourcePath,n.importPath)}};D.importResourcePathToString=je;var R={};Object.defineProperty(R,"__esModule",{value:!0});R.invokeUpdate=void 0;var Ce=function(n,t){var e,i="".concat(n.type,": ");switch(n.type){case"CodeChanged":i+="";break;case"ResolveNewImports":i+="";break;case"LookedUpTypeFile":i+='"'.concat(n.path,'" was ').concat(n.success?"sucessfully":"not sucessfully"," looked up");break;case"AttemptedLookUpFile":i+='"'.concat(n.path,'" was ').concat(n.success?"sucessfully":"not sucessfully"," attempted to looked up");break;case"LookedUpPackage":i+='package.json for package "'.concat(n.package,'" was ').concat(n.success?"sucessfully":"not sucessfully"," looked up").concat(n.definitelyTyped?" (found in definitely typed repo)":"");break;case"LoadedFromCache":i+='"'.concat(n.importPath,'" was loaded from cache');break;case"StoredToCache":i+='"'.concat(n.importPath,'" was stored to cache');break}i.endsWith(": ")&&(i=i.slice(void 0,-2)),(e=t.onUpdate)===null||e===void 0||e.call(t,n,i)};R.invokeUpdate=Ce;var T={};Object.defineProperty(T,"__esModule",{value:!0});T.RecursionDepth=void 0;var De=function(){function n(t,e,i){e===void 0&&(e=0),i===void 0&&(i=0),this.options=t,this.fileRecursionDepth=e,this.packageRecursionDepth=i}return n.prototype.nextPackage=function(){return new n(this.options,this.fileRecursionDepth,this.packageRecursionDepth+1)},n.prototype.nextFile=function(){return new n(this.options,this.fileRecursionDepth+1,this.packageRecursionDepth)},n.prototype.same=function(){return new n(this.options,this.fileRecursionDepth,this.packageRecursionDepth)},n.prototype.shouldStop=function(){return this.options.fileRecursionDepth>0&&this.fileRecursionDepth>=this.options.fileRecursionDepth||this.options.packageRecursionDepth>0&&this.packageRecursionDepth>=this.options.packageRecursionDepth},n}();T.RecursionDepth=De;var E=l&&l.__assign||function(){return E=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},E.apply(this,arguments)},Re=l&&l.__createBinding||(Object.create?function(n,t,e,i){i===void 0&&(i=e);var a=Object.getOwnPropertyDescriptor(t,e);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,a)}:function(n,t,e,i){i===void 0&&(i=e),n[i]=t[e]}),Te=l&&l.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Me=l&&l.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&Re(t,n,e);return Te(t,n),t},S=l&&l.__awaiter||function(n,t,e,i){function a(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function c(u){try{o(i.next(u))}catch(d){s(d)}}function f(u){try{o(i.throw(u))}catch(d){s(d)}}function o(u){u.done?r(u.value):a(u.value).then(c,f)}o((i=i.apply(n,t||[])).next())})},O=l&&l.__generator||function(n,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(o){return function(u){return f([o,u])}}function f(o){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,a&&(r=o[0]&2?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){e.label=o[1];break}if(o[0]===6&&e.label<r[1]){e.label=r[1],r=o;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(o);break}r[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(u){o=[6,u],a=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},B=l&&l.__values||function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ie=l&&l.__read||function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var i=e.call(n),a,r=[],s;try{for(;(t===void 0||t-- >0)&&!(a=i.next()).done;)r.push(a.value)}catch(c){s={error:c}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(s)throw s.error}}return r};Object.defineProperty($,"__esModule",{value:!0});$.ImportResolver=void 0;var Ee=L,Fe=D,_=Me(U()),b=R,Ue=T,Ne=function(){function n(t){var e,i;if(this.options=t,this.loadedFiles=[],this.dependencyParser=new Ee.DependencyParser,this.cache=t.sourceCache,this.sourceResolver=t.sourceResolver,this.newImportsResolved=!1,this.monaco=t.monaco,t.preloadPackages&&t.versions){this.versions=t.versions;try{for(var a=B(Object.entries(t.versions)),r=a.next();!r.done;r=a.next()){var s=Ie(r.value,2),c=s[0],f=s[1];this.resolveImport({kind:"package",packageName:c,importPath:""},new Ue.RecursionDepth(this.options)).catch(function(o){console.error(o)})}}catch(o){e={error:o}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}}}return n.prototype.wereNewImportsResolved=function(){return this.newImportsResolved},n.prototype.resetNewImportsResolved=function(){this.newImportsResolved=!1},n.prototype.resolveImportsInFile=function(t,e,i){var a,r,s;return S(this,void 0,void 0,function(){var c,f,o,u,d,y,v,h;return O(this,function(p){switch(p.label){case 0:if(i.shouldStop())return[2];c=this.dependencyParser.parseDependencies(t,e),p.label=1;case 1:p.trys.push([1,8,9,10]),f=B(c),o=f.next(),p.label=2;case 2:if(o.done)return[3,7];u=o.value,p.label=3;case 3:return p.trys.push([3,5,,6]),[4,this.resolveImport(u,i)];case 4:return p.sent(),[3,6];case 5:return d=p.sent(),this.options.onError?(r=(a=this.options).onError)===null||r===void 0||r.call(a,(s=d.message)!==null&&s!==void 0?s:d):console.error(d),[3,6];case 6:return o=f.next(),[3,2];case 7:return[3,10];case 8:return y=p.sent(),v={error:y},[3,10];case 9:try{o&&!o.done&&(h=f.return)&&h.call(f)}finally{if(v)throw v.error}return[7];case 10:return[2]}})})},n.prototype.resolveImport=function(t,e){return S(this,void 0,void 0,function(){var i,a,r;return O(this,function(s){switch(s.label){case 0:if(i=this.hashImportResourcePath(t),this.loadedFiles.includes(i))return[2];switch(this.loadedFiles.push(i),a=t.kind,a){case"package":return[3,1];case"relative":return[3,5];case"relative-in-package":return[3,6]}return[3,8];case 1:return[4,this.resolveImportFromPackageRoot(t)];case 2:return r=s.sent(),r?[4,this.resolveImportInPackage(r,e.nextPackage().nextFile())]:[3,4];case 3:return[2,s.sent()];case 4:return[3,8];case 5:throw Error("Not implemented yet");case 6:return[4,this.resolveImportInPackage(t,e.nextFile())];case 7:return[2,s.sent()];case 8:return[2]}})})},n.prototype.resolveImportInPackage=function(t,e){return S(this,void 0,void 0,function(){var i,a,r;return O(this,function(s){switch(s.label){case 0:return[4,this.loadSourceFileContents(t)];case 1:return i=s.sent(),i?(a=i.source,r=i.at,this.createModel(a,this.monaco.Uri.parse(this.options.fileRootPath+_.join("node_modules/".concat(t.packageName),r))),[4,this.resolveImportsInFile(a,{kind:"relative-in-package",packageName:t.packageName,sourcePath:_.dirname(r),importPath:""},e)]):[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}})})},n.prototype.resolveImportFromPackageRoot=function(t){var e,i,a,r,s,c,f,o,u;return S(this,void 0,void 0,function(){var d,y,v,h,p,w,m,g,k,w;return O(this,function(P){switch(P.label){case 0:return d={type:"LookedUpPackage",package:t.packageName,definitelyTyped:!1,success:!1},this.options.onlySpecifiedPackages&&!(!((e=this.versions)===null||e===void 0)&&e[t.packageName])&&!(!((i=this.versions)===null||i===void 0)&&i["@types/"+t.packageName])?((0,b.invokeUpdate)(d,this.options),[2]):(y=(r=(a=t.importPath)===null||a===void 0?void 0:a.length)!==null&&r!==void 0?r:0>0,v=y?"/".concat(t.importPath):"",[4,this.resolvePackageJson(t.packageName,(s=this.versions)===null||s===void 0?void 0:s[t.packageName],y?t.importPath:void 0)]);case 1:return h=P.sent(),!h&&y?[4,this.resolvePackageJson(t.packageName,(c=this.versions)===null||c===void 0?void 0:c[t.packageName])]:[3,3];case 2:h=P.sent(),v="",P.label=3;case 3:return h?(p=JSON.parse(h),p.typings||p.types?(w=p.typings||p.types,this.createModel(h,this.monaco.Uri.parse("".concat(this.options.fileRootPath,"node_modules/").concat(t.packageName).concat(v,"/package.json"))),(0,b.invokeUpdate)({type:"LookedUpPackage",package:t.packageName,definitelyTyped:!1,success:!0},this.options),this.setVersion(t.packageName,p.version),[2,{kind:"relative-in-package",packageName:t.packageName,sourcePath:"",importPath:_.join((f=t.importPath)!==null&&f!==void 0?f:"",w.startsWith("./")?w.slice(2):w)}]):[3,4]):[3,7];case 4:return m="@types/".concat(t.packageName.startsWith("@")?t.packageName.slice(1).replace(/\//,"__"):t.packageName),[4,this.resolvePackageJson(m,(o=this.versions)===null||o===void 0?void 0:o[m])];case 5:if(g=P.sent(),g){if(k=JSON.parse(g),k.typings||k.types)return w=k.typings||k.types,this.createModel(g,this.monaco.Uri.parse("".concat(this.options.fileRootPath,"node_modules/").concat(m,"/package.json"))),(0,b.invokeUpdate)({type:"LookedUpPackage",package:m,definitelyTyped:!0,success:!0},this.options),this.setVersion(m,k.version),[2,{kind:"relative-in-package",packageName:m,sourcePath:"",importPath:_.join((u=t.importPath)!==null&&u!==void 0?u:"",w.startsWith("./")?w.slice(2):w)}];(0,b.invokeUpdate)(d,this.options)}else(0,b.invokeUpdate)(d,this.options);P.label=6;case 6:return[3,8];case 7:(0,b.invokeUpdate)(d,this.options),P.label=8;case 8:return[2]}})})},n.prototype.loadSourceFileContents=function(t){return S(this,void 0,void 0,function(){var e,i,a,r,s,h,c,f,o,v,h,u,d,y,v,h,p,m;return O(this,function(g){switch(g.label){case 0:return e=_.join(t.packageName,t.sourcePath,t.importPath),i={type:"LookedUpTypeFile",path:e,definitelyTyped:!1,success:!1},a=t.packageName,r=this.getVersion(t.packageName),s=[".d.ts","/index.d.ts",".ts",".tsx","/index.ts","/index.tsx"],s.map(function(k){return t.importPath.endsWith(k)}).reduce(function(k,w){return k||w},!1)?[4,this.resolveSourceFile(a,r,_.join(t.sourcePath,t.importPath))]:[3,2];case 1:return h=g.sent(),h?[2,{source:h,at:_.join(t.sourcePath,t.importPath)}]:[3,9];case 2:g.trys.push([2,7,8,9]),c=B(s),f=c.next(),g.label=3;case 3:return f.done?[3,6]:(o=f.value,v=_.join(t.sourcePath,t.importPath)+o,[4,this.resolveSourceFile(a,r,v)]);case 4:if(h=g.sent(),(0,b.invokeUpdate)({type:"AttemptedLookUpFile",path:_.join(a,v),success:!!h},this.options),h)return(0,b.invokeUpdate)({type:"LookedUpTypeFile",path:_.join(a,v),success:!0},this.options),[2,{source:h,at:v}];g.label=5;case 5:return f=c.next(),[3,3];case 6:return[3,9];case 7:return u=g.sent(),p={error:u},[3,9];case 8:try{f&&!f.done&&(m=c.return)&&m.call(c)}finally{if(p)throw p.error}return[7];case 9:return[4,this.resolvePackageJson(a,r,_.join(t.sourcePath,t.importPath))];case 10:return d=g.sent(),d?(y=JSON.parse(d).types,y?(v=_.join(t.sourcePath,t.importPath,y),[4,this.resolveSourceFile(a,r,v)]):[3,12]):[3,12];case 11:if(h=g.sent(),h)return(0,b.invokeUpdate)({type:"LookedUpTypeFile",path:_.join(a,v),success:!0},this.options),[2,{source:h,at:v}];g.label=12;case 12:return(0,b.invokeUpdate)(i,this.options),[2,null]}})})},n.prototype.getVersion=function(t){var e;return(e=this.versions)===null||e===void 0?void 0:e[t]},n.prototype.setVersions=function(t){var e,i;this.versions=t,(i=(e=this.options).onUpdateVersions)===null||i===void 0||i.call(e,t)},n.prototype.setVersion=function(t,e){var i;this.setVersions(E(E({},this.versions),(i={},i[t]=e,i)))},n.prototype.createModel=function(t,e){e=e.with({path:e.path.replace("@types/","")}),this.monaco.editor.getModel(e)||(this.monaco.editor.createModel(t,"typescript",e),this.newImportsResolved=!0)},n.prototype.hashImportResourcePath=function(t){return(0,Fe.importResourcePathToString)(t)},n.prototype.resolvePackageJson=function(t,e,i){return S(this,void 0,void 0,function(){var a,r,s,c;return O(this,function(f){switch(f.label){case 0:return a=_.join(t+(e?"@".concat(e):""),i??"","package.json"),r=!1,s=void 0,this.cache.isFileAvailable?[4,this.cache.isFileAvailable(a)]:[3,2];case 1:return r=f.sent(),[3,4];case 2:return[4,this.cache.getFile(a)];case 3:s=f.sent(),r=s!==void 0,f.label=4;case 4:return r?s==null?[3,5]:(c=s,[3,7]):[3,8];case 5:return[4,this.cache.getFile(a)];case 6:c=f.sent(),f.label=7;case 7:return[2,c];case 8:return[4,this.sourceResolver.resolvePackageJson(t,e,i)];case 9:return s=f.sent(),s&&this.cache.storeFile(a,s),[2,s]}})})},n.prototype.resolveSourceFile=function(t,e,i){return S(this,void 0,void 0,function(){var a,r,s,c;return O(this,function(f){switch(f.label){case 0:return a=_.join(t+(e?"@".concat(e):""),i),r=!1,s=void 0,this.cache.isFileAvailable?[4,this.cache.isFileAvailable(a)]:[3,2];case 1:return r=f.sent(),[3,4];case 2:return[4,this.cache.getFile(a)];case 3:s=f.sent(),r=s!==void 0,f.label=4;case 4:return r?((0,b.invokeUpdate)({type:"LoadedFromCache",importPath:a},this.options),s==null?[3,5]:(c=s,[3,7])):[3,8];case 5:return[4,this.cache.getFile(a)];case 6:c=f.sent(),f.label=7;case 7:return[2,c];case 8:return[4,this.sourceResolver.resolveSourceFile(t,e,i)];case 9:return s=f.sent(),s&&((0,b.invokeUpdate)({type:"StoredToCache",importPath:a},this.options),this.cache.storeFile(a,s)),[2,s]}})})},n}();$.ImportResolver=Ne;var j=l&&l.__assign||function(){return j=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},j.apply(this,arguments)},xe=l&&l.__createBinding||(Object.create?function(n,t,e,i){i===void 0&&(i=e);var a=Object.getOwnPropertyDescriptor(t,e);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,a)}:function(n,t,e,i){i===void 0&&(i=e),n[i]=t[e]}),Ae=l&&l.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),$e=l&&l.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&xe(t,n,e);return Ae(t,n),t},M=l&&l.__awaiter||function(n,t,e,i){function a(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function c(u){try{o(i.next(u))}catch(d){s(d)}}function f(u){try{o(i.throw(u))}catch(d){s(d)}}function o(u){u.done?r(u.value):a(u.value).then(c,f)}o((i=i.apply(n,t||[])).next())})},I=l&&l.__generator||function(n,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(o){return function(u){return f([o,u])}}function f(o){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,a&&(r=o[0]&2?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){e.label=o[1];break}if(o[0]===6&&e.label<r[1]){e.label=r[1],r=o;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(o);break}r[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(u){o=[6,u],a=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Le=l&&l.__values||function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(x,"__esModule",{value:!0});x.AutoTypingsCore=void 0;var Ve=A,Ke=C,Ge=$,Je=$e(U()),H=R,Be=T,We=function(){function n(t,e){var i=this;this.editor=t,this.options=e,this.disposables=[],this.importResolver=new Ge.ImportResolver(e);var a=t.onDidChangeModelContent(function(r){i.debouncedResolveContents()});this.disposables.push(a),this.resolveContents(),e.dontAdaptEditorOptions||e.monaco.languages.typescript.typescriptDefaults.setCompilerOptions(j(j({},e.monaco.languages.typescript.typescriptDefaults.getCompilerOptions()),{moduleResolution:e.monaco.languages.typescript.ModuleResolutionKind.NodeJs,allowSyntheticDefaultImports:!0,rootDir:e.fileRootPath}))}return n.create=function(t,e){var i;return M(this,void 0,void 0,function(){var a;return I(this,function(r){if(e?.shareCache&&e.sourceCache&&!n.sharedCache&&(n.sharedCache=e.sourceCache),a=e?.monaco,!a)throw new Error("monacoInstance not found, you can specify the monaco instance via options.monaco");return[2,new n(t,j(j({fileRootPath:"inmemory://model/",onlySpecifiedPackages:!1,preloadPackages:!1,shareCache:!1,dontAdaptEditorOptions:!1,dontRefreshModelValueAfterResolvement:!1,sourceCache:(i=n.sharedCache)!==null&&i!==void 0?i:new Ve.DummySourceCache,sourceResolver:new Ke.UnpkgSourceResolver,debounceDuration:4e3,fileRecursionDepth:10,packageRecursionDepth:3},e),{monaco:a}))]})})},n.prototype.dispose=function(){var t,e;try{for(var i=Le(this.disposables),a=i.next();!a.done;a=i.next()){var r=a.value;r.dispose()}}catch(s){t={error:s}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},n.prototype.setVersions=function(t){this.importResolver.setVersions(t),this.options.versions=t},n.prototype.clearCache=function(){return M(this,void 0,void 0,function(){return I(this,function(t){switch(t.label){case 0:return[4,this.options.sourceCache.clear()];case 1:return t.sent(),[2]}})})},n.prototype.debouncedResolveContents=function(){var t=this;this.isResolving||((0,H.invokeUpdate)({type:"CodeChanged"},this.options),this.options.debounceDuration<=0?this.resolveContents():(this.debounceTimer!==void 0&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){return M(t,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:return[4,this.resolveContents()];case 1:return e.sent(),this.debounceTimer=void 0,[2]}})})},this.options.debounceDuration)))},n.prototype.resolveContents=function(){var t;return M(this,void 0,void 0,function(){var e,i,a,r;return I(this,function(s){switch(s.label){case 0:if(this.isResolving=!0,(0,H.invokeUpdate)({type:"ResolveNewImports"},this.options),e=this.editor.getModel(),!e)throw Error("No model");i=e.getLinesContent(),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.importResolver.resolveImportsInFile(i.join(`
`),Je.dirname(e.uri.toString()),new Be.RecursionDepth(this.options))];case 2:return s.sent(),[3,4];case 3:if(a=s.sent(),this.options.onError)this.options.onError((t=a.message)!==null&&t!==void 0?t:a);else throw a;return[3,4];case 4:return this.importResolver.wereNewImportsResolved()&&(this.options.dontRefreshModelValueAfterResolvement||(r=this.editor.getPosition(),e.setValue(e.getValue()),r&&this.editor.setPosition(r)),this.importResolver.resetNewImportsResolved()),this.isResolving=!1,[2]}})})},n}();x.AutoTypingsCore=We;const Xe=oe(se);var qe=l&&l.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),F=l&&l.__assign||function(){return F=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},F.apply(this,arguments)},ze=l&&l.__createBinding||(Object.create?function(n,t,e,i){i===void 0&&(i=e);var a=Object.getOwnPropertyDescriptor(t,e);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,a)}:function(n,t,e,i){i===void 0&&(i=e),n[i]=t[e]}),He=l&&l.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Qe=l&&l.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&ze(t,n,e);return He(t,n),t},Ye=l&&l.__awaiter||function(n,t,e,i){function a(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function c(u){try{o(i.next(u))}catch(d){s(d)}}function f(u){try{o(i.throw(u))}catch(d){s(d)}}function o(u){u.done?r(u.value):a(u.value).then(c,f)}o((i=i.apply(n,t||[])).next())})},Ze=l&&l.__generator||function(n,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(o){return function(u){return f([o,u])}}function f(o){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,a&&(r=o[0]&2?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){e.label=o[1];break}if(o[0]===6&&e.label<r[1]){e.label=r[1],r=o;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(o);break}r[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(u){o=[6,u],a=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(N,"__esModule",{value:!0});N.AutoTypings=void 0;var Q=x,et=function(n){qe(t,n);function t(e,i){return n.call(this,e,i)||this}return t.create=function(e,i){var a;return Ye(this,void 0,void 0,function(){var r,s,c,f,o,u;return Ze(this,function(d){switch(d.label){case 0:return s=(r=Q.AutoTypingsCore).create,c=[e],f=[F({},i)],u={},(a=i?.monaco)!==null&&a!==void 0?(o=a,[3,3]):[3,1];case 1:return[4,Promise.resolve().then(function(){return Qe(Xe)})];case 2:o=d.sent(),d.label=3;case 3:return[4,s.apply(r,c.concat([F.apply(void 0,f.concat([(u.monaco=o,u)]))]))];case 4:return[2,d.sent()]}})})},t}(Q.AutoTypingsCore);N.AutoTypings=et;var V={},W=l&&l.__awaiter||function(n,t,e,i){function a(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function c(u){try{o(i.next(u))}catch(d){s(d)}}function f(u){try{o(i.throw(u))}catch(d){s(d)}}function o(u){u.done?r(u.value):a(u.value).then(c,f)}o((i=i.apply(n,t||[])).next())})},X=l&&l.__generator||function(n,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(o){return function(u){return f([o,u])}}function f(o){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,a&&(r=o[0]&2?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,a=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){e.label=o[1];break}if(o[0]===6&&e.label<r[1]){e.label=r[1],r=o;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(o);break}r[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(n,e)}catch(u){o=[6,u],a=0}finally{i=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(V,"__esModule",{value:!0});V.LocalStorageCache=void 0;var tt=function(){function n(){this.localCache={}}return n.prototype.getFile=function(t){var e;return W(this,void 0,void 0,function(){return X(this,function(i){try{return[2,(e=localStorage.getItem(n.LOCALSTORAGE_PREFIX+t))!==null&&e!==void 0?e:void 0]}catch{return[2,this.localCache[t]]}return[2]})})},n.prototype.storeFile=function(t,e){return W(this,void 0,void 0,function(){return X(this,function(i){this.localCache[t]=e;try{localStorage.setItem(n.LOCALSTORAGE_PREFIX+t,e)}catch{}return[2]})})},n.prototype.clear=function(){return W(this,void 0,void 0,function(){var t,e;return X(this,function(i){for(this.localCache={},t=0;t<localStorage.length;t++)e=localStorage.key(t),e?.startsWith(n.LOCALSTORAGE_PREFIX)&&localStorage.removeItem(e);return[2]})})},n.LOCALSTORAGE_PREFIX="__autotyper_cache_",n}();V.LocalStorageCache=tt;var Z={};Object.defineProperty(Z,"__esModule",{value:!0});var ee={};Object.defineProperty(ee,"__esModule",{value:!0});var te={};Object.defineProperty(te,"__esModule",{value:!0});var re={};Object.defineProperty(re,"__esModule",{value:!0});(function(n){var t=l&&l.__createBinding||(Object.create?function(i,a,r,s){s===void 0&&(s=r);var c=Object.getOwnPropertyDescriptor(a,r);(!c||("get"in c?!a.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return a[r]}}),Object.defineProperty(i,s,c)}:function(i,a,r,s){s===void 0&&(s=r),i[s]=a[r]}),e=l&&l.__exportStar||function(i,a){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(a,r)&&t(a,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),e(N,n),e(D,n),e(V,n),e(Z,n),e(ee,n),e(te,n),e(re,n),e(C,n)})(z);const lt=n=>{const t=Y(n.value);return q(()=>n.value,e=>{t.value=e}),t},ft=(n,t,e,i)=>{const{unSaveConfirm:a=!0,...r}=i;le(a,()=>!1,"是否确定离开？"),ae();const s=Y(!1),c={editor:null,module:null,loaded:null,Snip:fe({setup(){return()=>s.value?null:de(ie,{description:"Monaco 体积较大耐心等待加载完成..."})}})},{isDark:f}=ce(ue);he(t),c.loaded=s,q(()=>t.value,d=>{const y=c.editor;y&&d!=y.getValue()&&y.setValue(d)}),q(()=>f.value,d=>{c.editor.updateOptions({theme:d?"dark":"light"})});let o=null,u;return pe(()=>{ne(()=>import("./editor.main-2236456e.js").then(d=>d.e),["js/editor.main-2236456e.js","js/editor.api-cae69a5e.js","assets/editor-7a4e943b.css","js/preload-helper-f651ca80.js","js/monaco.contribution-c3c8f3e4.js","assets/editor-90fabead.css"]).then(d=>{const y={...r,value:t.value,theme:f.value?"dark":"light",automaticLayout:!0,cursorStyle:"line-thin",minimap:{enabled:!1},tabSize:2,fontFamily:"operator mono, fira code, monaco, monospace",fontSize:14};if(y.language==="typescript"){const h=d.editor.createModel(t.value,"typescript");Object.assign(y,{model:h}),o=h}c.editor=d.editor.create(n.value,y),u=z.AutoTypings.create(c.editor,{sourceCache:new z.LocalStorageCache,preloadPackages:!0,versions:{"@types/node":"^18"}}),c.module=d,["onKeyDown","onDidPaste","onDidBlurEditorText"].forEach(h=>{const p=c.editor;p[h](()=>{const m=p.getValue();e(m)})}),c.editor.addAction({id:"trigger-suggestion",label:"Trigger Suggestion",keybindings:[d.KeyMod.Shift|d.KeyCode.Space],run:()=>{c.editor.trigger("","editor.action.triggerSuggest",{})}}),c.editor.addAction({id:"format",label:"Format Document",keybindings:[d.KeyMod.Shift|d.KeyCode.KeyF|d.KeyMod.CtrlCmd],run:()=>{c.editor.trigger("","editor.action.formatDocument",{})}});function v(h){const p=[d.KeyCode.KeyS,d.KeyCode.KeyF];(h.ctrlKey||h.metaKey)&&p.includes(h.keyCode)&&h.preventDefault()}c.editor.onKeyDown(h=>{v(h)}),c.editor.onKeyUp(h=>{v(h)}),s.value=!0})}),ve(async()=>{c.editor?.dispose?.(),c.editor=null,c.module=null,await u.then(d=>{d?.dispose()}),o?.dispose()}),c};export{lt as a,ft as u};
